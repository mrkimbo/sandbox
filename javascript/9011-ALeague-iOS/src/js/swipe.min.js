Hammer(document.body,{drag_max_touches:1,drag_block_vertical:true,drag_lock_to_axis:true}).on("release dragleft dragright swipeleft swiperight",handleTouchEvent);function redrawPages(c){var a=document.querySelectorAll(".page");var b=Math.round(mainDiv.clientWidth*0.95),d=a.length;page=new Rect(b,a[0].clientHeight);container.style.width=content.style.width=(b*a.length)+1+"px";while(d--){if(parseInt(a[d].id.replace(/[^0-9]*/g,""))%totalPages==0){a[d].style.width=mainDiv.clientWidth+"px";continue}a[d].style.width=b+"px"}setDragPos(0)}function handleTouchEvent(a){a.gesture.preventDefault();switch(a.type){case"dragleft":case"dragright":setDragPos(a.gesture.deltaX,a.gesture.direction);break;case"swipeleft":next();a.gesture.stopDetect();break;case"swiperight":prev();a.gesture.stopDetect();break;case"release":if(Math.abs(a.gesture.deltaX)>(page.width*0.3)){(a.gesture.direction==Hammer.DIRECTION_LEFT)?next():prev()}else{cancelDrag()}break}}function next(){if(idx==3){idx=2}container.addEventListener("webkitTransitionEnd",onTransitionEnd,false);container.className=content.className="animate";setPageX(page.width*(++idx)*-1)}function prev(){if(idx==0){idx=1}container.addEventListener("webkitTransitionEnd",onTransitionEnd,false);container.className=content.className="animate";setPageX(page.width*(--idx)*-1)}function cancelDrag(){container.addEventListener("webkitTransitionEnd",onTransitionEnd,false);container.className=content.className="animate";setPageX(page.width*idx*-1)}function setDragPos(b,d){container.className=content.className="";container.clientWidth;var a,c;c=(100/page.width)*b;a=(page.width/100)*c;a=Math.max(-page.width,Math.min(page.width,a));if((idx==0&&d==Hammer.DIRECTION_RIGHT)||(idx==totalPages-1&&d==Hammer.DIRECTION_LEFT)){a*=0.4}setPageX((page.width*idx*-1)+a)}function setPageX(a){if(!transformProp){transformProp=getTransformProp()}container.style[transformProp]=content.style[transformProp]="translate3d("+a+"px,0,0) scale3d(1,1,1)";interruptAnim()};