"use strict";var elements={root:document.find("#main-container"),loader:document.find("#loader"),header:document.find("#header"),scrollBox:document.find("#scroll-box"),scroll:document.find("#scroll"),container:document.find("#page-container"),nav:document.find("nav"),score:document.find("#score"),timer:document.find("#timer"),results:{score:document.find("#page4 .results .title"),timer:document.find("#page4 .results .time"),prize:document.find("#page4 .value")},pages:document.findAll(".page"),btns:document.findAll(".options .btn"),ctaBtn:document.find(".cta .btn")};var answers=[0,0,0];var prizes=["$10","$10","$100","$500"];var dirty=false,pos;var maxScroll,timeScale=1;var screenSize=new Rect();var timerRunning=false;var prop,style=document.documentElement.style;var _raf=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;init();function init(){window.scrollEnabled=true;Hammer(elements.root,{drag_max_touches:1,drag_block_horizontal:true,drag_lock_to_axis:true}).on("touch dragup dragdown swipeup swipedown release",handleTouchEvent);elements.scrollBox.addEventListener("scroll",redraw,false);elements.btns.forEach(function(a){a.addEventListener("click",optionClickHandler,false)});elements.ctaBtn.addEventListener("click",ctaClickHandler,false);if(isTouchEnabled()){elements.container.style.left=0;elements.nav.style.right=0}onResize(null);elements.loader.classList.add("hidden");elements.container.classList.remove("hidden");elements.root.classList.remove("loading");resetTimer();snapToQuestion();redrawScores();redrawTimer();log("Ready..")}function onResize(a){redrawPages();redrawTweens();onTimelineUpdate()}function redrawPages(){var a;elements.scrollBox.style.height=elements.root.clientHeight-78+"px";maxScroll=elements.scrollBox.scrollHeight-elements.scrollBox.clientHeight;screenSize.width=elements.scrollBox.clientWidth;screenSize.height=elements.scrollBox.clientHeight;a=elements.pages[2].find(".options");TweenLite.set(a,{x:(screenSize.width-1008)*0.5});a=elements.pages[1].find(".cricket-ball");TweenLite.set(a,{x:(screenSize.width*0.5)-100,y:screenSize.height+100})}function loop(){if(dirty){tick();checkDirty()}_raf(loop)}loop();function redraw(a){pos=getScrollTime();MainTimeline.seek(pos);onTimelineUpdate()}function redrawScores(){elements.score.textContent=elements.results.score.textContent=getScore().toString()+"/"+(elements.pages.length-1).toString();elements.results.prize.textContent=prizes[getScore()]}function redrawTimer(){elements.timer.textContent=elements.results.timer.textContent=getTimeString()}var lastScrollPos;function handleTouchEvent(a){if(!scrollEnabled){return}switch(a.type){case"touch":if(a.target instanceof HTMLButtonElement){return}lastScrollPos=elements.scrollBox.scrollTop;break;case"dragup":case"dragdown":if(scrollTween){scrollTween.kill()}elements.scrollBox.scrollTop=(lastScrollPos-a.gesture.deltaY);break;case"swipeup":var b=Math.min(elements.pages.length,getCurrentPage()+1);scrollToQuestion(b);a.gesture.stopDetect();break;case"swipedown":var b=Math.max(1,getCurrentPage()-1);scrollToQuestion(b);a.gesture.stopDetect();break;case"release":snapToQuestion();break}a.gesture.preventDefault()}function checkDirty(){dirty=timerRunning}function ctaClickHandler(){alert("CTA Button clicked")}var _scrollEnabled=true;Object.defineProperty(window,"scrollEnabled",{set:function(a){_scrollEnabled=a;if(a){elements.scrollBox.classList.remove("disabled")}else{elements.scrollBox.classList.add("disabled")}},get:function(){return _scrollEnabled}});